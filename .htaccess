# Proteção contra hotlinking para arquivos de upload

# Permite acesso do domínio guardamemoria.com.br, localhost:3000, srv1664-files.hstgr.io e files.admtiago.com.br

RewriteEngine On

# Lista de extensões de arquivo a proteger

RewriteCond %{REQUEST_FILENAME} \.(jpg|jpeg|png|gif|webp|svg|mp4|avi|mov|wmv|mkv|mp3|wav|ogg|m4a|flac|pdf|doc|docx|txt|rtf)$ [NC]

# Bloqueia se o referrer não for dos domínios autorizados ou estiver vazio

RewriteCond %{HTTP_REFERER} !^https?://(www\.)?guardamemoria\.com\.br(/._)?$ [NC]
RewriteCond %{HTTP_REFERER} !^http://localhost:3000(/._)?$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://srv1664-files\.hstgr\.io(/._)?$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://files\.admtiago\.com\.br(/._)?$ [NC]
RewriteCond %{HTTP_REFERER} !^$

# Retorna erro 403 Forbidden

RewriteRule ^ - [F,L]

# Ou redireciona para uma página de erro (descomente se preferir)

# RewriteRule ^ /erro-acesso-negado.html [L]
